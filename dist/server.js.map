{"version":3,"sources":["webpack:///webpack/bootstrap ffac0400f8cb8d4e9455","webpack:///./src/server.js","webpack:///external \"path\"","webpack:///external \"https\"","webpack:///external \"fs\"","webpack:///external \"express\"","webpack:///external \"body-parser\"","webpack:///./src/app/router.js","webpack:///./src/api/apiRouter.js","webpack:///./src/api/controllers/appsController.js","webpack:///external \"lodash\"","webpack:///./src/config.js","webpack:///./config/environment.js","webpack:///./src/api/clients.js","webpack:///./src/api/clients/appClient.js","webpack:///./src/api/clients/containerClient.js","webpack:///./src/api/dataloader.js","webpack:///external \"dataloader\"","webpack:///external \"superagent\"","webpack:///external \"url\""],"names":["server","set","use","static","join","__dirname","json","req","res","callback","config","clients","dataloader","get","header","end","listen","console","log","router","sendFile","root","appsController","show","AppsController","appClient","params","id","catch","err","then","app","AppClient","undefined","create","body","update","delete","sendStatus","port","process","env","PORT","host","WEBSITE_HOSTNAME","redis","hostname","sprinklr","protocol","sprinklr_auth","containerClient","attributes","db","extend","projectId","slug","settings","Promise","resolve","reject","collection","insert","appId","ops","container","merge","_id","findOneAndUpdate","$set","returnOriginal","value","index","containers","each","deleteOne","omit","ContainerClient","pathname","name","type","title","path","javascriptUrls","stylesheetUrls","meta","post","createContainer","resource","containerId","templateType","resourceClient","put","formatUrl","format","request","method","options","Error","url","headers","defaults","cookie","send","args","all","map","load","head"],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ffac0400f8cb8d4e9455","import path from 'path';\nimport https from 'https';\nimport fs from 'fs';\nimport express from 'express';\nimport bodyParser from 'body-parser';\n// import React from 'react';\n// import ReactDOM from 'react-dom/server';\nimport appRouter from './app/router';\nimport apiRouter from './api/apiRouter';\n// import Html from './components/Html';\n// import assets from './assets';\nimport { host, port } from './config';\nimport environment from '../config/environment';\nimport clients from './api/clients';\nimport dataloader from './api/dataloader';\n\nconst server = express();\n\nserver.set('port', port);\n\n// // Register Node.js middleware\nserver.use(express.static(path.join(__dirname, 'public')));\nserver.use(bodyParser.json());\n\nserver.use('*', (req, res, callback) => {\n    req.config =  environment;\n    req.clients = clients(server, req);\n    req.dataloader = dataloader(server, req);\n    callback();\n});\n\nserver.use(appRouter);\nserver.use('/api', apiRouter);\n\nserver.get('/', function (req, res) {\n   res.header('Content-type', 'text/html');\n   return res.end('<h1>Hello, Secure World!</h1>');\n });\n\n\n// server.get('/', function (req, res) {\n//   res.send('Hello World');\n// })\n\n// // Register API middleware\n// // -----------------------------------------------------------------------------\n// server.use('/api/content', Api.default);\n//\n\n\n\n\n\n//\n// Launch the server\n// -----------------------------------------------------------------------------\n\n// https.createServer({\n//   key: fs.readFileSync('key.pem'),\n//   cert: fs.readFileSync('cert.pem')\n// }, server).listen(port,() => {\n//   console.log(arguments[0]);\n// //   /* eslint-disable no-console */\n//   console.log(`The server is running at https://localhost:${port}/`);\n// });\n\nserver.listen(port, () => {\n  /* eslint-disable no-console */\n  console.log(`The server is running at http://localhost:${port}/`);\n});\n\nexport default server;\n\n\n\n// WEBPACK FOOTER //\n// ./src/server.js","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"https\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"https\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 5\n// module chunks = 0","import { Router } from 'express';\n\nconst router =  new Router();\n\nrouter.get('/ui/*', (req, res) => {\n  res.sendFile('/dist/public/index.html', {root: '.'});\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/router.js","import { Router } from 'express';\nimport AppsController from './controllers/appsController';\nconst router = new Router(),\n      appsController = new AppsController();\n\n// Experiences\nrouter.get('/test', appsController.show);\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/apiRouter.js","import _ from 'lodash';\n\n\nclass AppsController {\n    show(req, res, callback) {\n        req.clients.appClient.show(req.params.id).catch((err) => {\n            callback(err);\n        }).then((app) => {\n            res.json(app);\n        });\n    }\n\n    create(req, res, callback) {\n         AppClient( undefined,req).create(req.body).catch((err) => {\n            callback(err);\n        }).then((app) => {\n            res.json(app);\n        });\n    }\n\n    update(req, res, callback) {\n         AppClient( undefined,req).update(req.body, req.params.id).catch((err) => {\n            callback(err);\n        }).then((app) => {\n            res.json(app);\n        });\n    }\n\n    delete(req, res, callback) {\n         AppClient( undefined,req).delete(req.params.id).catch((err) => {\n            callback(err);\n        }).then(() => {\n            res.sendStatus(202);\n        });\n    }\n}\n\nexport default AppsController;\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/controllers/appsController.js","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 9\n// module chunks = 0","export const port = process.env.PORT || 3000;\nexport const host = process.env.WEBSITE_HOSTNAME || `localhost:${port}`;\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","const env = {};\n\n// session store\nenv.redis = {\n    hostname: 'localhost',\n    port: '6379'\n};\n\n// sprinklr api host addresses\nenv.sprinklr = {\n    hostname: 'localhost',\n    port: '8443',\n    protocol: 'https:'\n};\n\n// sprinklr auth host addresses (this lives on UI as of this writing)\nenv.sprinklr_auth = {\n    hostname: 'localhost',\n    port: '8443',\n    protocol: 'https:'\n};\n\n// app internal host\nenv.app = {\n    hostname: 'localhost',\n    port: '5000',\n    protocol: 'http:'\n};\n\n// app public host\nenv.host = {\n    hostname: 'localhost',\n    port: '5000',\n    protocol: 'http:'\n};\n\nexport default env;\n\n\n\n// WEBPACK FOOTER //\n// ./config/environment.js","import appClient from './clients/appClient';\nimport containerClient from './clients/containerClient';\n\nexport default (app, req) => {\n    return {\n        // Client instances:\n        appClient: appClient(app, req),\n        containerClient: containerClient(app, req)\n    };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/clients.js","import _ from 'lodash';\nimport ContainerClient from './containerClient';\n\nexport default (app, req) => {\n    class AppClient {\n\n\n    show(id) {\n      return req.dataloader.get('/ui/rest/user/status');\n    }\n\n    create(attributes) {\n        let containerClient = new ContainerClient(this.db);\n\n        attributes = _.extend({\n            id: null,\n            projectId: null,\n            slug: null,\n            settings: {}\n        }, attributes);\n\n        return new Promise((resolve, reject) => {\n            this.collection.insert(attributes).catch((err) => {\n                reject(err);\n            }).then((app) => {\n                containerClient.create({ appId: app.ops[0].id }).catch((err) => {\n                    reject(err);\n                }).then((container) => {\n                    resolve(_.merge(app.ops[0], {\n                        container: container\n                    }));\n                });\n            });\n        });\n    }\n\n    update(attributes, id) {\n        return new Promise((resolve, reject) => {\n            delete attributes._id; // eslint-disable-line no-underscore-dangle\n\n            this.collection.findOneAndUpdate({ id: id }, { $set: attributes }, { returnOriginal: false }).catch((err) => {\n                reject(err);\n            }).then((app) => {\n                resolve(app.value);\n            });\n        });\n    }\n\n    delete(id) {\n        let containerClient = new ContainerClient(this.db);\n\n        return new Promise((resolve, reject) => {\n            containerClient.index(id).catch((err) => {\n                reject(err);\n            }).then((containers) => {\n                _.each(containers, (container) => containerClient.delete(container.id));\n            });\n\n            this.collection.deleteOne({ id: id }).catch((err) => {\n                reject(err);\n            }).then(() => {\n                resolve();\n            });\n        });\n    }\n\n    import(app) {\n        app = _.omit(app, '_id');\n        return this.collection.insert(app);\n    }\n  }\n\n  return new AppClient();\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/clients/appClient.js","import _ from 'lodash';\n\nexport default (app, req) => {\n    class ContainerClient {\n        index(projectId) {\n            const pathname = `/projects/${projectId}/containers`;\n            return req.dataloader.get(pathname);\n        }\n\n        show(id) {\n            const pathname = `/containers/${id}`;\n            return req.dataloader.get(pathname);\n        }\n\n        // 'private' method\n        createContainer(attributes) {\n            const pathname = '/containers';\n\n            attributes = _.extend({\n                name: 'UntitledContainer',\n                projectId: null,\n                type: 'PAGE',\n                settings: {\n                    title: 'Default',\n                    path: 'untitledPath',\n                    javascriptUrls: [],\n                    stylesheetUrls: [],\n                    meta: {}\n                }\n            }, attributes);\n\n            return req.dataloader.post(pathname, { body: attributes });\n        }\n\n        create(attributes) {\n            return this.createContainer(attributes).then((container) => {\n                const resource = {\n                    containerId: container.containerId,\n                    projectId: container.projectId,\n                    templateType: attributes.templateType\n                };\n\n                if (container.type === 'FRAGMENT') {\n                    resource.name = container.name;\n                }\n\n                return req.clients.resourceClient\n                    .create(resource)\n                    .then(() => container);\n            });\n        }\n\n        update(container) {\n            const pathname = `/containers/${container.containerId}`;\n            return req.dataloader.put(pathname, { body: container });\n        }\n\n        delete(containerId) {\n            const pathname = `/containers/${containerId}`;\n            return req.dataloader.delete(pathname);\n        }\n\n        // FIXME - this no longer works since the migration to the core API\n        //         we will need new endpoints for this\n        import(container) {\n            console.log(container);\n        }\n    }\n\n    return new ContainerClient();\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/clients/containerClient.js","import _ from 'lodash';\nimport Dataloader from 'dataloader';\nimport superagent from 'superagent';\nimport url from 'url';\n\nexport default (app, req) => {\n    function formatUrl(pathname) {\n        const config = req.config.sprinklr;\n\n        return url.format({\n            protocol: config.protocol,\n            hostname: config.hostname,\n            pathname: `/api/micro/service/xb${pathname}`,\n            port: config.port\n        });\n    }\n\n    function request(pathname, method = 'get', options = {}) {\n        return new Promise((resolve, reject) => {\n\n            if (!pathname) {\n                return reject(new Error('A pathname is required to make a request.'));\n            }\n\n            const url = formatUrl(pathname);\n\n            const headers = _.defaults({}, options.headers, {\n                'Content-Type': 'application/json',\n                // 'X-SPR-Authorization': `Bearer ${req.session.accessToken.text}`,\n                'Cookie': req.headers.cookie\n            });\n\n            const request = superagent[method](url).set(headers);\n\n            if (options.body) {\n                request.send(options.body);\n            }\n\n            request.end((err, res) => {\n                if (err) {\n                    return reject(err);\n                }\n\n                return resolve(res.body);\n            });\n        });\n    }\n\n    const dataloader = new Dataloader((args) => {\n        // NOTE: Only to be used by GET requests\n        return Promise.all(args.map((args) => request(args.pathname, 'get', args.options)));\n    });\n\n    return {\n        delete(pathname, options = {}) {\n            return request(pathname, 'delete', options);\n        },\n\n        get(pathname, options = {}) {\n            // Cache all GET request made in a single Express.js request\n            return dataloader.load({ pathname, options });\n            // return request(pathname);\n        },\n\n        head(pathname, options = {}) {\n            return request(pathname, 'head', options);\n        },\n\n        post(pathname, options = {}) {\n            return request(pathname, 'post', options);\n        },\n\n        put(pathname, options = {}) {\n            return request(pathname, 'put', options);\n        }\n    };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/dataloader.js","module.exports = require(\"dataloader\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dataloader\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"superagent\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"superagent\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"url\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"url\"\n// module id = 18\n// module chunks = 0"],"sourceRoot":""}